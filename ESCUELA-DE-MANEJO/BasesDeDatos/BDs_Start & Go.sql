CREATE DATABASE IF NOT EXISTS prueba;
USE prueba;

CREATE TABLE IF NOT EXISTS usuario (
    usuario_id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_nombre VARCHAR(50) NOT NULL UNIQUE,
    usuario_clave VARCHAR(255) NOT NULL 
);

INSERT INTO usuario (usuario_nombre, usuario_clave) VALUES
('admin', MD5('admin')),
('cliente', MD5('cliente')),
('recepcionista', MD5('recepcionista')),
('empleado', MD5('empleado'));

select* from usuario;

/*========================================================*/
CREATE TABLE EMPLEADOS (
	RFC_EMP VARCHAR (13) NOT NULL PRIMARY KEY,
	NOMB_EMP VARCHAR (10) NOT NULL,
	AP_EMP VARCHAR (10) NOT NULL,
	AM_EMP VARCHAR (10) NOT NULL,
	PUESTO VARCHAR (20) NOT NULL,
	SEXO ENUM ('MASCULINO', 'FEMENINO') NOT NULL,
	FECHA_NAC DATE NOT NULL,
	TEL_PERSONAL INT NOT NULL,
	CALLE VARCHAR (20) NOT NULL,
	NUMERO INT NOT NULL,
	COLONIA VARCHAR (30) NOT NULL,
	ALCALDIA VARCHAR (20) NOT NULL
);


/*modificacion 19-06-2025*/
ALTER TABLE EMPLEADOS MODIFY NOMB_EMP VARCHAR(20);
ALTER TABLE EMPLEADOS MODIFY AP_EMP VARCHAR(20);
ALTER TABLE EMPLEADOS MODIFY AM_EMP VARCHAR(20);

CREATE TABLE CONTRATACION (
	TIPO_CONTRATACION VARCHAR (10) NOT NULL PRIMARY KEY,
	PRECIO INT NOT NULL,
	DESC_BENEFICIOS VARCHAR (50) NOT NULL
);

CREATE TABLE AUTOS_ASIGNADOS (
    MATRICULA VARCHAR(10) NOT NULL PRIMARY KEY,
    RFC_EMP VARCHAR(13) NOT NULL, 
    MODELO VARCHAR(20) NOT NULL,
    ANIO YEAR, 
    COLOR VARCHAR(20),
    FECHA_ULT_INSP DATE,
    ESTATUS ENUM('DISPONIBLE', 'NO DISPONIBLE', 'BAJA') NOT NULL,
    FOREIGN KEY (RFC_EMP) REFERENCES EMPLEADOS(RFC_EMP)
);


CREATE TABLE CLIENTES (
	RFC_CLIENTE VARCHAR (13) NOT NULL PRIMARY KEY,
	TIPO_CONTRATACION VARCHAR (10) NOT NULL,
	FOREIGN KEY (TIPO_CONTRATACION) REFERENCES CONTRATACION (TIPO_CONTRATACION),
	NOMB_CLI VARCHAR (10) NOT NULL,
	AP_CLI VARCHAR (10) NOT NULL,
	AM_CLI VARCHAR (10) NOT NULL,
	FECHA_NAC DATE NOT NULL,
	CALLE VARCHAR (20) NOT NULL,
	NUMERO INT NOT NULL,
	COLONIA VARCHAR (30) NOT NULL,
	ALCALDIA VARCHAR (20) NOT NULL,
	PERMISO ENUM ('SI', 'NO', 'EN TRÁMITE'),
	OBSERVACIONES VARCHAR (30),
	TOTAL_PAGO INT NOT NULL,
	PAGO1 INT,
	PAGO2 INT,
	ADEUDO INT,
	USUARIO VARCHAR (30) NOT NULL,
	DOMINIO VARCHAR (20) NOT NULL
);

/*Ejecutar 23/06/2025*/
ALTER TABLE CLIENTES 
ADD FECHA_PAGO DATE NOT NULL 
AFTER OBSERVACIONES;

CREATE TABLE AGENDA (
    FECHA DATE NOT NULL,
    HORA TIME NOT NULL,
    RFC_CLIENTE VARCHAR(13) NOT NULL,
    RFC_EMP VARCHAR(13) NOT NULL,
    ACTIVIDAD ENUM('EXAMEN', 'LECCIÓN'),
    KM_RECORRIDOS INT,
    NOTAS VARCHAR(50),
    EXAM_TEO INT,
    EXAM_PRAC INT,
    NOTAS_RESULTADO VARCHAR(50),
    PRIMARY KEY (FECHA, HORA, RFC_EMP),
    FOREIGN KEY (RFC_EMP) REFERENCES EMPLEADOS(RFC_EMP),
    FOREIGN KEY (RFC_CLIENTE) REFERENCES CLIENTES (RFC_CLIENTE)
);


ALTER TABLE CLIENTES DROP COLUMN PAGO1;
ALTER TABLE CLIENTES DROP COLUMN PAGO2;
ALTER TABLE CLIENTES DROP COLUMN ADEUDO;

ALTER TABLE EMPLEADOS MODIFY COLUMN TEL_PERSONAL BIGINT NOT NULL;

SELECT * FROM AGENDA;

ALTER TABLE CLIENTES ADD COLUMN FORMA_PAGO ENUM ('DEBITO', 'CRÉDITO', 'EFECTIVO', 'TRANSFERENCIA') AFTER TOTAL_PAGO;
ALTER TABLE CLIENTES ADD COLUMN REEMBOLSO BOOLEAN DEFAULT FALSE AFTER FORMA_PAGO;

ALTER TABLE AGENDA MODIFY COLUMN RFC_EMP VARCHAR(13) NOT NULL FIRST;

ALTER TABLE AUTOS_ASIGNADOS MODIFY RFC_EMP VARCHAR(13) NULL;

ALTER TABLE EMPLEADOS ADD COLUMN TURNO ENUM('MATUTINO','VESPERTINO') NOT NULL AFTER PUESTO;
ALTER TABLE EMPLEADOS ADD COLUMN DESCANSOS VARCHAR (30) NOT NULL AFTER TURNO;


INSERT INTO CONTRATACION (TIPO_CONTRATACION, PRECIO, DESC_BENEFICIOS)
VALUES ('BÁSICO', 2000, '7 DÍAS, 3HRS X DÍA'),
('INTERMEDIO', 3500, '12 DÍAS, 3.5HRS X DÍA'),
('PREMIUM', 5000, '18 DÍAS, 4HRS X DÍA');


INSERT INTO EMPLEADOS 
(RFC_EMP, NOMB_EMP, AP_EMP, AM_EMP, PUESTO, TURNO, DESCANSOS, SEXO, FECHA_NAC, TEL_PERSONAL, CALLE, NUMERO, COLONIA, ALCALDIA)
VALUES
('GARC900101HDF', 'ANA', 'GARCÍA', 'LOPEZ', 'INSTRUCTORA', 'MATUTINO', 'LUNES,MARTES', 'FEMENINO', '1990-01-01', 5541234567, 'MIGUEL HIDALGO', 12, 'DEL VALLE', 'BENITO JUÁREZ'),
('LOPE920304MDF', 'LUIS', 'LOPEZ', 'MORALES', 'ADMINISTRADOR', 'MATUTINO', 'SÁBADO,DOMINGO', 'MASCULINO', '1992-03-04', 5512345678, 'INSURGENTES SUR', 245, 'NÁPOLES', 'BENITO JUÁREZ'),
('FERJ850715HDF', 'JUAN', 'FERNANDEZ', 'RODRIGUEZ', 'RECEPCIONISTA', 'MATUTINO', 'SÁBADO,LUNES', 'MASCULINO', '1985-07-15', 5556677889, 'CENTENARIO', 33, 'ROMA NORTE', 'CUAUHTÉMOC');

/*registros Completos*/
INSERT INTO EMPLEADOS 
(RFC_EMP, NOMB_EMP, AP_EMP, AM_EMP, PUESTO, TURNO, DESCANSOS, SEXO, FECHA_NAC, TEL_PERSONAL, CALLE, NUMERO, COLONIA, ALCALDIA)
VALUES
('VELM870610HDF', 'MARIO', 'VELAZQUEZ', 'MARTINEZ', 'INSTRUCTOR', 'MATUTINO', 'MIÉRCOLES,VIERNES', 'MASCULINO', '1987-06-10', 5578912345, 'TACUBA', 77, 'SAN RAFAEL', 'CUAUHTÉMOC'),
('REYG940420HDF', 'GABRIEL', 'REYES', 'GUTIÉRREZ', 'INSTRUCTOR', 'MATUTINO', 'SÁBADO,DOMINGO', 'MASCULINO', '1994-04-20', 5522233344, 'FRAY SERVANDO', 88, 'OBRERA', 'CUAUHTÉMOC'),
('SALM860927MDF', 'MONICA', 'SALAZAR', 'MORA', 'INSTRUCTORA', 'VESPERTINO', 'VIERNES,SÁBADO', 'FEMENINO', '1986-09-27', 5533344455, 'EJE CENTRAL', 333, 'CENTRO', 'CUAUHTÉMOC'),
('LOZR970708HDF', 'RAFAEL', 'LOZANO', 'RIVERA', 'INSTRUCTOR', 'VESPERTINO', 'MARTES,JUEVES', 'MASCULINO', '1997-07-08', 5544455566, 'PATRIOTISMO', 11, 'ESPARTACO', 'COYOACÁN'),
('MOSE030526A50', 'ERICK', 'MONROY', 'SANTANA', 'SUPERVISOR', 'MATUTINO', 'SÁBADO,DOMINGO', 'MASCULINO', '2003-05-26', 5540608099, 'LAS FLORES', 9, 'PASCUAL', 'IZTACALCO'),
('RAMC880908MDF', 'CLAUDIA', 'RAMIREZ', 'CASTILLO', 'RECEPCIONISTA', 'VESPERTINO', 'MARTES,DOMINGO', 'FEMENINO', '1988-09-08', 5567891234, 'DIVISIÓN DEL NORTE', 140, 'PORTALES', 'BENITO JUÁREZ'),
('ORTA930505MDF', 'TERESA', 'ORTEGA', 'AGUILAR', 'LIMPIEZA', 'VESPERTINO', 'SÁBADO, MIÉRCOLES', 'FEMENINO', '1993-05-05', 5589123456, 'ZARAGOZA', 180, 'MOCTEZUMA', 'VENUSTIANO CARRANZA'),
('CRUZ930409HDF', 'DAVID', 'CRUZ', 'MARTÍNEZ', 'LIMPIEZA', 'MATUTINO', 'LUNES,DOMINGO', 'MASCULINO', '1993-04-09', 5534567890, 'AV. OCEANÍA', 72, 'MOCTEZUMA', 'VENUSTIANO CARRANZA');



INSERT INTO AUTOS_ASIGNADOS (MATRICULA, RFC_EMP, MODELO, ANIO, COLOR, FECHA_ULT_INSP, ESTATUS)
VALUES('XYZ5678', 'GARC900101HDF', 'Chevrolet Aveo', 2021, 'Blanco', '2025-04-20', 'DISPONIBLE');

/*registros Completos*/
INSERT INTO AUTOS_ASIGNADOS (MATRICULA, RFC_EMP, MODELO, ANIO, COLOR, FECHA_ULT_INSP, ESTATUS)VALUES
('ABC1234', 'MOSE030526A50', 'Nissan Versa', 2022, 'Rojo', '2025-05-01', 'DISPONIBLE'),
('JKL3456', 'VELM870610HDF', 'Toyota Yaris', 2023, 'Gris', '2025-06-01', 'DISPONIBLE'),
('EELL3001', NULL, 'Kia Forte', 2022, 'Blanco', '2025-05-01', 'BAJA'),
('MNO7890', 'REYG940420HDF', 'Volkswagen Vento', 2020, 'Negro', '2025-03-15', 'DISPONIBLE'),
('ZZZ1001', 'VELM870610HDF', 'Toyota Corolla', 2020, 'Negro', '2024-12-15', 'BAJA'),
('YYY2001', 'SALM860927MDF', 'Hyundai Grand i10', 2021, 'Rojo', '2025-01-12', 'NO DISPONIBLE'),
('YYY2002', 'SALM860927MDF', 'Hyundai Accent', 2022, 'Azul', '2025-06-01', 'DISPONIBLE'),
('NNLL3002', NULL, 'Mazda 2', 2021, 'Rojo', '2025-03-20', 'NO DISPONIBLE');

INSERT INTO CLIENTES (
    RFC_CLIENTE, TIPO_CONTRATACION, NOMB_CLI, AM_CLI, AP_CLI, 
    FECHA_NAC, CALLE, NUMERO, COLONIA, ALCALDIA, PERMISO, OBSERVACIONES, 
    FECHA_PAGO, TOTAL_PAGO, FORMA_PAGO, REEMBOLSO, USUARIO, DOMINIO
)
VALUES
('JUAP910101HDF', 'BÁSICO', 'JUAN', 'PÉREZ', 'ALVAREZ', '1991-01-01', 'REFORMA', 100, 'CENTRO', 'CUAUHTÉMOC', 'SI', 'ANSIEDAD GENERALIZADA', '2025-06-01', 2000, 'EFECTIVO', FALSE, 'jperez', 'hotmail.com');

/*Mas registros de clientes con fecha*/
INSERT INTO CLIENTES (
    RFC_CLIENTE, TIPO_CONTRATACION, NOMB_CLI, AM_CLI, AP_CLI, 
    FECHA_NAC, CALLE, NUMERO, COLONIA, ALCALDIA, PERMISO, OBSERVACIONES, 
    FECHA_PAGO, TOTAL_PAGO, FORMA_PAGO, REEMBOLSO, USUARIO, DOMINIO
)VALUES
('MARG920202MDF', 'PREMIUM', 'MARÍA', 'GÓMEZ', 'RAMÍREZ', '1992-02-02', 'INSURGENTES', 200, 'DEL VALLE', 'BENITO JUÁREZ', 'SI', 'LESIÓN EN BRAZO DERECHO', '2025-06-05', 5000, 'TRANSFERENCIA', FALSE, 'mgomez', 'gmail.com'),
('LUIC930303HDF', 'INTERMEDIO', 'LUIS', 'CANO', 'SANTOS', '1993-03-03', 'MIGUEL HIDALGO', 35, 'POLANCO', 'MIGUEL HIDALGO', 'EN TRÁMITE', 'LESIÓN DE RODILLA IZQUIERDA', '2025-06-10', 3500, 'DÉBITO', TRUE, 'lcano', 'outlook.com'),
('SAND940404MDF', 'PREMIUM', 'SANDRA', 'MARTÍNEZ', 'LARA', '1994-04-04', 'DIVISIÓN DEL NORTE', 80, 'PORTALES', 'BENITO JUÁREZ', 'NO', 'DIABETES', '2025-06-12', 5000, 'EFECTIVO', FALSE, 'smartinez', 'yahoo.com'),
('CARF950505HDF', 'BÁSICO', 'CARLOS', 'FLORES', 'MEJÍA', '1995-05-05', 'ZARAGOZA', 150, 'MOCTEZUMA', 'VENUSTIANO CARRANZA', 'SI', 'ANSIEDAD', '2025-06-15', 2000, 'TRANSFERENCIA', FALSE, 'cflores', 'hotmail.com'),
('ANEL960606MDF', 'INTERMEDIO', 'ANA', 'LEÓN', 'SILVA', '1996-06-06', 'AV. UNIVERSIDAD', 77, 'COPILCO', 'COYOACÁN', 'SI', 'VÉRTIGO LEVE', '2025-06-18', 3500, 'CRÉDITO', TRUE, 'aleon', 'gmail.com'),
('JORR970707HDF', 'PREMIUM', 'JORGE', 'ROJAS', 'REYES', '1997-07-07', 'PATRIOTISMO', 99, 'NÁPOLES', 'BENITO JUÁREZ', 'SI', 'HIPERTENSIÓN CONTROLADA', '2025-06-20', 5000, 'TRANSFERENCIA', FALSE, 'jrojas', 'outlook.com'),
('LUIM980808MDF', 'BÁSICO', 'LUISA', 'MENDOZA', 'TORRES', '1998-08-08', 'TLALPAN', 55, 'LA JOYA', 'TLALPAN', 'EN TRÁMITE', 'VISTA REDUCIDA (USA LENTES)', '2025-06-22', 2000, 'EFECTIVO', TRUE, 'lmendoza', 'gmail.com'),
('RAFM990909HDF', 'INTERMEDIO', 'RAFAEL', 'MORA', 'CASTRO', '1999-09-09', 'EJE CENTRAL', 120, 'OBRERA', 'CUAUHTÉMOC', 'SI', NULL, '2025-06-25', 3500, 'CRÉDITO', FALSE, 'rmora', 'hotmail.com'),
('VERC000101MDF', 'PREMIUM', 'VERÓNICA', 'CARRILLO', 'NAVARRO', '2000-01-01', 'CENTENARIO', 67, 'SAN RAFAEL', 'CUAUHTÉMOC', 'SI', 'EPILEPSIA LEVE (CONTROLADA)', '2025-06-28', 5000, 'TRANSFERENCIA', FALSE, 'vcarrillo', 'yahoo.com'),
('OSCJ010202HDF', 'BÁSICO', 'OSCAR', 'JUÁREZ', 'VALDÉS', '2001-02-02', 'CUITLAHUAC', 45, 'TACUBA', 'MIGUEL HIDALGO', 'NO', 'DIABETES', '2025-06-30', 2000, 'EFECTIVO', FALSE, 'ojuarez', 'outlook.com'),
('MARL020303MDF', 'INTERMEDIO', 'MARTHA', 'LOZANO', 'RIVERA', '2002-03-03', 'RIO CHURUBUSCO', 90, 'AGRÍCOLA', 'IZTACALCO', 'SI', NULL, '2025-07-01', 3500, 'DÉBITO', TRUE, 'mlozano', 'gmail.com'),
('PEDA030404HDF', 'PREMIUM', 'PEDRO', 'ALVAREZ', 'GONZÁLEZ', '2003-04-04', 'AV. COYOACÁN', 88, 'XOLA', 'BENITO JUÁREZ', 'SI', NULL, '2025-07-03', 5000, 'TRANSFERENCIA', FALSE, 'palvarez', 'hotmail.com'),
('DEYR040505MDF', 'BÁSICO', 'DÉBORA', 'YÁÑEZ', 'RUIZ', '2004-05-05', 'FRAY SERVANDO', 100, 'OBRERA', 'CUAUHTÉMOC', 'SI', 'ESGUINCE RECIENTE EN TOBILLO', '2025-07-05', 2000, 'EFECTIVO', TRUE, 'dyanez', 'gmail.com'),
('FELN050606HDF', 'INTERMEDIO', 'FELIPE', 'NAVARRO', 'DÍAZ', '2005-06-06', 'TAXQUEÑA', 132, 'SAN FRANCISCO', 'COYOACÁN', 'EN TRÁMITE', NULL, '2025-07-07', 3500, 'CRÉDITO', FALSE, 'fnavarro', 'yahoo.com');


INSERT INTO AGENDA (RFC_EMP, FECHA, HORA, RFC_CLIENTE, ACTIVIDAD, KM_RECORRIDOS, NOTAS, EXAM_TEO, EXAM_PRAC, NOTAS_RESULTADO) 
VALUES
('GARC900101HDF', '2025-06-10', '08:00:00', 'JUAP910101HDF', 'LECCIÓN', 10, 'Buen avance', NULL, NULL, NULL);
/*registros Completos*/
INSERT INTO AGENDA (RFC_EMP, FECHA, HORA, RFC_CLIENTE, ACTIVIDAD, KM_RECORRIDOS, NOTAS, EXAM_TEO, EXAM_PRAC, NOTAS_RESULTADO) 
VALUES
('VELM870610HDF', '2025-06-11', '08:00:00', 'MARG920202MDF', 'EXAMEN', 15, NULL, 85, 90, 'Aprobado'),
('REYG940420HDF', '2025-06-12', '09:00:00', 'LUIC930303HDF', 'LECCIÓN', 12, 'Trabajar curvas', NULL, NULL, NULL),
('SALM860927MDF', '2025-06-12', '15:00:00', 'SAND940404MDF', 'EXAMEN', 8, 'Dolor en brazo', 90, 75, 'Aprobado'),
('VELM870610HDF', '2025-06-11', '11:00:00', 'DEYR040505MDF', 'LECCIÓN', 5, 'Ataque de ansiedad', NULL, NULL, NULL),
('LOZR970708HDF', '2025-06-13', '16:00:00', 'CARF950505HDF', 'LECCIÓN', 20, 'Buen ritmo', NULL, NULL, NULL);


ALTER TABLE EMPLEADOS
MODIFY COLUMN TURNO ENUM('MATUTINO', 'VESPERTINO') NOT NULL AFTER PUESTO;



SELECT * FROM CLIENTES;
SELECT * FROM usuario;
SELECT * FROM EMPLEADOS;
SELECT * FROM AGENDA;
SELECT * FROM AUTOS_ASIGNADOS;
SELECT * FROM CONTRATACION;
/*Fecha 23/06/2025   Realizar solo si ya se habia creado la base de datos antes de esta fecha,  eliminar las agendas relacionadas*/

DELETE FROM CLIENTES;

ALTER TABLE CLIENTES 
ADD FECHA_PAGO DATE NOT NULL 
AFTER OBSERVACIONES;
/*Ejecutar los insert de clientes y luego de agendas que estan arriba*/